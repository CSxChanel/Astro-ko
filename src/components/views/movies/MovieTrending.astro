---
import MovieSkeleton from "./MovieSkeleton.jsx"
import Card from "../../utils/Card.astro"
const apiKey = import.meta.env.APP_APIKEY;
const baseUrl = import.meta.env.APP_BASEURL;

let trendingMovies = [];

try {
	const response = await fetch(`${baseUrl}/trending/movie/day?language=en-US&page=1&region=ID&api_key=${apiKey}`);
	const data = await response.json();

	trendingMovies = data.results;
} catch (error) {
	console.error('Error fetching upcoming movies:', error);
}
---
<div class="mx-2 lg:container mb-11">
	<div class="flex justify-between mb-4 mt-9">
		<h2 class="text-xl text-slate-100 font-primary">Trending-Movie</h2>
	</div>
	<div class="flex space-x-4 lg:gap-5 snap-x overflow-x-auto scroll-smooth">
		{trendingMovies.length > 0
		? trendingMovies.map(movie => (
			<div
				key={movie.id }
			class="min-w-[155px] md:min-w-[170px] lg:min-w-[180px] flex flex-col"
			>
			<Card key={movie.id } type="movie" media={movie } />
	</div>
)): Array.from({
	length: 10
}).map((_, index) => (
	<MovieSkeleton key={index } />
))}
</div>
</div>